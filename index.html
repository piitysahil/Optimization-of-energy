<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Energy Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: #1f2937;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 5px solid;
        }
        
        .stat-card.blue { border-left-color: #3b82f6; }
        .stat-card.green { border-left-color: #10b981; }
        .stat-card.purple { border-left-color: #8b5cf6; }
        .stat-card.orange { border-left-color: #f59e0b; }
        
        .stat-header {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stat-value.blue { color: #3b82f6; }
        .stat-value.green { color: #10b981; }
        .stat-value.purple { color: #8b5cf6; }
        .stat-value.orange { color: #f59e0b; }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .chart-container h2 {
            color: #1f2937;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .predictions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .prediction-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .recommendations {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .recommendation-item {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .live-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
            margin-right: 8px;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .ml-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .ml-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .ml-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .algorithm-tag {
            display: inline-block;
            background: rgba(16, 185, 129, 0.8);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 10px;
        }

        .optimization-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .optimization-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .appliance-list {
            list-style: none;
        }

        .appliance-item {
            display: flex;
            justify-content: between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            background: #f8fafc;
            border-left: 4px solid;
        }

        .appliance-item.low { border-left-color: #ef4444; }
        .appliance-item.medium { border-left-color: #f59e0b; }
        .appliance-item.high { border-left-color: #10b981; }

        .appliance-name {
            font-weight: 600;
            flex: 1;
        }

        .appliance-usage {
            margin: 0 15px;
            color: #6b7280;
        }

        .efficiency-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .efficiency-badge.low { background: #fee2e2; color: #dc2626; }
        .efficiency-badge.medium { background: #fef3c7; color: #d97706; }
        .efficiency-badge.high { background: #d1fae5; color: #059669; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° Smart Energy Dashboard</h1>
            <p>AI-Powered Energy Monitoring & Optimization</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card blue">
                <div class="stat-header">Current Usage</div>
                <div class="stat-value blue">
                    <span class="live-indicator"></span>
                    <span id="current-usage">3.24</span> kW
                </div>
            </div>
            
            <div class="stat-card green">
                <div class="stat-header">Today's Savings</div>
                <div class="stat-value green">$<span id="savings">3.24</span></div>
            </div>
            
            <div class="stat-card purple">
                <div class="stat-header">Efficiency Score</div>
                <div class="stat-value purple"><span id="efficiency">87</span>%</div>
            </div>
            
            <div class="stat-card orange">
                <div class="stat-header">CO‚ÇÇ Saved</div>
                <div class="stat-value orange"><span id="co2">2.1</span> kg</div>
            </div>
        </div>
        
        <div class="ml-section">
            <h2>ü§ñ Machine Learning Predictions</h2>
            <p>AI algorithms analyzing your energy patterns in real-time</p>
            <div class="ml-grid">
                <div class="ml-card">
                    <h3>Next Hour Forecast</h3>
                    <div style="font-size: 2rem; font-weight: bold; margin: 10px 0;">
                        <span id="ml-prediction">4.2</span> kW
                    </div>
                    <div class="algorithm-tag">Linear Regression</div>
                </div>
                <div class="ml-card">
                    <h3>Confidence Score</h3>
                    <div style="font-size: 2rem; font-weight: bold; margin: 10px 0;">
                        <span id="ml-confidence">89</span>%
                    </div>
                    <div class="algorithm-tag">Neural Network</div>
                </div>
                <div class="ml-card">
                    <h3>Usage Trend</h3>
                    <div style="font-size: 1.5rem; font-weight: bold; margin: 10px 0;" id="ml-trend">
                        Increasing ‚ÜóÔ∏è
                    </div>
                    <div class="algorithm-tag">Time Series Analysis</div>
                </div>
                <div class="ml-card">
                    <h3>Anomaly Detection</h3>
                    <div style="font-size: 1.5rem; font-weight: bold; margin: 10px 0;" id="anomaly-status">
                        Normal ‚úÖ
                    </div>
                    <div class="algorithm-tag">Isolation Forest</div>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <h2>üìä Energy Usage vs ML Prediction</h2>
            <canvas id="usageChart" height="100"></canvas>
        </div>
        
        <div class="chart-container">
            <h2>üè† Appliance Usage Breakdown</h2>
            <canvas id="applianceChart" height="100"></canvas>
        </div>
        
        <div class="optimization-section">
            <h2>‚öôÔ∏è AI Optimization Analysis</h2>
            <div class="optimization-grid">
                <div>
                    <h3>Appliance Efficiency Ratings</h3>
                    <ul class="appliance-list">
                        <li class="appliance-item low">
                            <span class="appliance-name">Water Heater</span>
                            <span class="appliance-usage">25% usage</span>
                            <span class="efficiency-badge low">Low</span>
                        </li>
                        <li class="appliance-item high">
                            <span class="appliance-name">LED Lighting</span>
                            <span class="appliance-usage">15% usage</span>
                            <span class="efficiency-badge high">High</span>
                        </li>
                        <li class="appliance-item medium">
                            <span class="appliance-name">HVAC System</span>
                            <span class="appliance-usage">45% usage</span>
                            <span class="efficiency-badge medium">Medium</span>
                        </li>
                        <li class="appliance-item high">
                            <span class="appliance-name">Refrigerator</span>
                            <span class="appliance-usage">5% usage</span>
                            <span class="efficiency-badge high">High</span>
                        </li>
                        <li class="appliance-item high">
                            <span class="appliance-name">Electronics</span>
                            <span class="appliance-usage">10% usage</span>
                            <span class="efficiency-badge high">High</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <canvas id="optimizationChart" height="200"></canvas>
                </div>
            </div>
        </div>

        <div class="recommendations">
            <h2>üí° AI-Powered Smart Recommendations</h2>
            <div id="recommendations-list">
                <div class="recommendation-item">
                    üïö Consider running dishwasher during off-peak hours (11PM-6AM) to save $0.15
                </div>
                <div class="recommendation-item">
                    üå°Ô∏è HVAC temperature is 2¬∞F higher than optimal - adjust for 8% savings
                </div>
                <div class="recommendation-item">
                    üîß Water heater shows inefficient patterns - schedule maintenance check
                </div>
                <div class="recommendation-item">
                    ‚ö° Peak usage detected - defer non-essential appliances for next 2 hours
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==============================================
        // JAVASCRIPT SECTION - AI/ML ENERGY DASHBOARD
        // ==============================================
        
        // Global variables for charts and data
        let usageChart, applianceChart, optimizationChart;
        let historicalData = [];
        let currentTime = new Date();
        
        // Simulated ML Models and Algorithms
        const MLModels = {
            // Linear Regression for usage prediction
            linearRegression: function(currentUsage, timeOfDay, weatherFactor) {
                const timeWeight = timeOfDay > 18 ? 1.3 : (timeOfDay < 8 ? 0.7 : 1.0);
                return currentUsage * timeWeight * weatherFactor * (0.9 + Math.random() * 0.2);
            },
            
            // Neural Network confidence simulation
            neuralNetworkConfidence: function(prediction, actualUsage, historicalVariance) {
                const accuracy = 1 - Math.abs(prediction - actualUsage) / actualUsage;
                return Math.max(75, Math.min(95, accuracy * 100 + Math.random() * 10));
            },
            
            // Time Series Analysis for trend detection
            timeSeriesAnalysis: function(recentUsage) {
                if (recentUsage.length < 3) return 'Analyzing';
                const trend = recentUsage[recentUsage.length - 1] - recentUsage[0];
                return trend > 0.5 ? 'Increasing ‚ÜóÔ∏è' : trend < -0.5 ? 'Decreasing ‚ÜòÔ∏è' : 'Stable ‚û°Ô∏è';
            },
            
            // Isolation Forest for anomaly detection
            isolationForest: function(currentUsage, avgUsage) {
                const deviation = Math.abs(currentUsage - avgUsage) / avgUsage;
                return deviation > 0.3 ? 'Anomaly Detected ‚ö†Ô∏è' : 'Normal ‚úÖ';
            }
        };
        
        // Energy Data Simulator
        const EnergySimulator = {
            generateRealtimeUsage: function() {
                const hour = new Date().getHours();
                const baseUsage = this.getBaseUsageByHour(hour);
                const randomVariation = (Math.random() - 0.5) * 0.8;
                const seasonalFactor = Math.sin(Date.now() / 86400000) * 0.3;
                return Math.max(1, baseUsage + randomVariation + seasonalFactor);
            },
            
            getBaseUsageByHour: function(hour) {
                // Simulate realistic daily energy patterns
                if (hour >= 0 && hour < 6) return 2.5; // Night - low usage
                if (hour >= 6 && hour < 9) return 4.5; // Morning peak
                if (hour >= 9 && hour < 17) return 3.2; // Day - moderate
                if (hour >= 17 && hour < 22) return 5.8; // Evening peak
                return 3.0; // Late evening
            },
            
            generateWeatherFactor: function() {
                // Simulate weather impact on energy usage
                return 0.85 + Math.random() * 0.3; // 0.85 to 1.15 multiplier
            }
        };
        
        // Chart Initialization Functions
        function initializeCharts() {
            // Usage vs Prediction Chart
            const ctx1 = document.getElementById('usageChart').getContext('2d');
            usageChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: ['6 hrs ago', '5 hrs ago', '4 hrs ago', '3 hrs ago', '2 hrs ago', '1 hr ago', 'Now'],
                    datasets: [{
                        label: 'Actual Usage (kW)',
                        data: [2.1, 1.8, 4.2, 3.8, 5.1, 6.3, 4.5],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        borderWidth: 3,
                        fill: true
                    }, {
                        label: 'ML Prediction (kW)',
                        data: [2.3, 1.9, 4.5, 3.6, 4.9, 6.1, 4.2],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        title: {
                            display: true,
                            text: 'Real-time Energy Monitoring with AI Prediction'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Energy Usage (kW)' }
                        }
                    }
                }
            });
            
            // Appliance Usage Doughnut Chart
            const ctx2 = document.getElementById('applianceChart').getContext('2d');
            applianceChart = new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: ['HVAC System', 'Water Heater', 'LED Lighting', 'Electronics', 'Refrigerator'],
                    datasets: [{
                        data: [45, 25, 15, 10, 5],
                        backgroundColor: [
                            '#f59e0b', // HVAC - Orange (medium efficiency)
                            '#ef4444', // Water Heater - Red (low efficiency)
                            '#10b981', // Lighting - Green (high efficiency)
                            '#10b981', // Electronics - Green (high efficiency)
                            '#10b981'  // Refrigerator - Green (high efficiency)
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'right' },
                        title: {
                            display: true,
                            text: 'Current Appliance Energy Distribution'
                        }
                    }
                }
            });
            
            // Optimization Potential Chart
            const ctx3 = document.getElementById('optimizationChart').getContext('2d');
            optimizationChart = new Chart(ctx3, {
                type: 'bar',
                data: {
                    labels: ['Current Usage', 'Optimized Usage', 'Potential Savings'],
                    datasets: [{
                        label: 'Energy (kWh/day)',
                        data: [28.5, 22.3, 6.2],
                        backgroundColor: ['#6b7280', '#10b981', '#3b82f6'],
                        borderColor: ['#374151', '#059669', '#2563eb'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'AI-Calculated Optimization Potential'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Energy (kWh/day)' }
                        }
                    }
                }
            });
        }
        
        // Real-time Data Update Function
        function updateDashboard() {
            // Generate new energy data
            const currentUsage = EnergySimulator.generateRealtimeUsage();
            const weatherFactor = EnergySimulator.generateWeatherFactor();
            const hour = new Date().getHours();
            
            // Store historical data for ML analysis
            historicalData.push(currentUsage);
            if (historicalData.length > 24) historicalData.shift(); // Keep last 24 hours
            
            // Apply ML Models
            const prediction = MLModels.linearRegression(currentUsage, hour, weatherFactor);
            const confidence = MLModels.neuralNetworkConfidence(prediction, currentUsage, 0.3);
            const trend = MLModels.timeSeriesAnalysis(historicalData.slice(-6));
            const anomaly = MLModels.isolationForest(currentUsage, 3.5);
            
            // Update DOM elements
            document.getElementById('current-usage').textContent = currentUsage.toFixed(2);
            document.getElementById('ml-prediction').textContent = prediction.toFixed(2);
            document.getElementById('ml-confidence').textContent = Math.floor(confidence);
            document.getElementById('ml-trend').textContent = trend;
            document.getElementById('anomaly-status').textContent = anomaly;
            
            // Update other metrics with simulated ML calculations
            const savings = (2.5 + Math.random() * 2).toFixed(2);
            const efficiency = Math.floor(78 + Math.random() * 22);
            const co2 = (1.2 + Math.random() * 2).toFixed(1);
            
            document.getElementById('savings').textContent = savings;
            document.getElementById('efficiency').textContent = efficiency;
            document.getElementById('co2').textContent = co2;
            
            // Update charts with new data
            updateCharts(currentUsage, prediction);
            
            // Generate new AI recommendations
            updateRecommendations(currentUsage, hour, efficiency);
        }
        
        // Chart Update Function
        function updateCharts(currentUsage, prediction) {
            // Update usage chart
            usageChart.data.datasets[0].data.shift();
            usageChart.data.datasets[0].data.push(currentUsage);
            usageChart.data.datasets[1].data.shift();
            usageChart.data.datasets[1].data.push(prediction);
            usageChart.update('none');
            
            // Randomly update appliance distribution
            if (Math.random() < 0.1) { // 10% chance to update appliance data
                const newData = [
                    42 + Math.random() * 6, // HVAC
                    23 + Math.random() * 4, // Water Heater
                    13 + Math.random() * 4, // Lighting
                    8 + Math.random() * 4,  // Electronics
                    4 + Math.random() * 2   // Refrigerator
                ];
                applianceChart.data.datasets[0].data = newData;
                applianceChart.update('none');
            }
        }
        
        // AI Recommendations Generator
        function updateRecommendations(currentUsage, hour, efficiency) {
            const recommendations = [
                'üïö Run dishwasher during off-peak hours (11PM-6AM) - Save $0.12-0.18 daily',
                'üå°Ô∏è Lower HVAC by 2¬∞F during peak hours - Reduce usage by 8-12%',
                'üîß Water heater efficiency below optimal - Schedule maintenance for 15% improvement',
                '‚ö° Peak usage detected - Defer non-critical loads for 2 hours',
                'üí° Switch remaining incandescent bulbs to LED - Save $23/month',
                'üåô Enable sleep mode on electronics - Reduce standby power by 40%',
                '‚òÄÔ∏è Optimal solar panel time: 11AM-3PM - Use high-power appliances now',
                'üìä Usage pattern suggests occupancy change - Adjust smart thermostat schedule'
            ];
            
            // AI logic to select relevant recommendations
            let selectedRecs = [];
            
            if (hour >= 17 && hour <= 21) {
                selectedRecs.push(recommendations[0]); // Peak hours
                selectedRecs.push(recommendations[3]);
            }
            
            if (efficiency < 85) {
                selectedRecs.push(recommendations[1]); // Low efficiency
                selectedRecs.push(recommendations[2]);
            }
            
            if (currentUsage > 5) {
                selectedRecs.push(recommendations[3]); // High usage
            }
            
            // Add random recommendations to fill up to 4 total
            while (selectedRecs.length < 4) {
                const randomRec = recommendations[Math.floor(Math.random() * recommendations.length)];
                if (!selectedRecs.includes(randomRec)) {
                    selectedRecs.push(randomRec);
                }
            }
            
            // Update recommendations in DOM
            const recList = document.getElementById('recommendations-list');
            recList.innerHTML = '';
            selectedRecs.forEach(rec => {
                const div = document.createElement('div');
                div.className = 'recommendation-item';
                div.textContent = rec;
                recList.appendChild(div);
            });
        }
        
        // Initialize dashboard when page loads
        window.addEventListener('load', function() {
            console.log('üöÄ Smart Energy Dashboard Initializing...');
            console.log('ü§ñ Loading AI/ML Models...');
            
            initializeCharts();
            updateDashboard(); // Initial update
            
            // Set up real-time updates every 3 seconds
            setInterval(updateDashboard, 3000);
            
            console.log('‚úÖ Dashboard Ready! Real-time AI monitoring active.');
        });
        
        // Add some interactivity
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('stat-card')) {
                e.target.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    e.target.style.transform = 'scale(1)';
                }, 200);
            }
        });
    </script>
</body>
</html>